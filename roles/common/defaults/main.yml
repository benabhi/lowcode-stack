# ==============================================================================
# Role: common - Default Variables
# ==============================================================================

---
# Timezone and locale
common_timezone: "{{ lowcode_timezone | default('UTC') }}"
common_locale: "{{ lowcode_locale | default('en_US.UTF-8') }}"

# Base packages to install
common_packages:
  - apt-transport-https
  - ca-certificates
  - curl
  - gnupg
  - lsb-release
  - software-properties-common
  - git
  - htop
  - vim
  - unzip
  - jq
  - python3-pip
  - python3-docker
  - apache2-utils
  - ufw

# System upgrade settings
common_upgrade_packages: true
common_reboot_if_required: false

# Firewall (UFW) settings
common_firewall_enabled: true
common_firewall_default_incoming: "deny"
common_firewall_default_outgoing: "allow"
common_firewall_allowed_ports:
  - { port: 22, proto: tcp }
  - { port: 80, proto: tcp }
  - { port: 443, proto: tcp }

# Fail2ban settings
common_fail2ban_enabled: true
common_fail2ban_bantime: "1h"
common_fail2ban_findtime: "10m"
common_fail2ban_maxretry: 5

# Swap settings
common_swap_enabled: true
common_swap_size: "2G"
common_swap_swappiness: 10

# System user for services
common_system_user: "{{ lowcode_system_user | default('lowcode') }}"
common_system_group: "{{ lowcode_system_group | default('lowcode') }}"

# Base path for services
common_base_path: "{{ lowcode_base_path | default('/opt/lowcode-stack') }}"

# Kernel optimizations
common_sysctl_settings:
  # Network performance
  net.core.somaxconn: 65535
  net.core.netdev_max_backlog: 65535
  net.ipv4.tcp_max_syn_backlog: 65535
  net.ipv4.tcp_fin_timeout: 30
  net.ipv4.tcp_keepalive_time: 300
  net.ipv4.tcp_keepalive_probes: 5
  net.ipv4.tcp_keepalive_intvl: 15
  # Memory management
  vm.swappiness: 10
  vm.dirty_ratio: 60
  vm.dirty_background_ratio: 2
  # File descriptors
  fs.file-max: 2097152
